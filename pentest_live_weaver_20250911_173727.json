{
  "timestamp": "2025-09-11T17:37:27.826264",
  "target": "http://localhost:8002",
  "summary": {
    "total_vulnerabilities": 4,
    "critical_categories": [
      "Python Eval Injection"
    ],
    "high_categories": []
  },
  "vulnerabilities": [
    "Code execution possible: __import__('os').system('echo ",
    "Code execution possible: open('/etc/passwd').read()",
    "Code execution possible: __import__('sys').modules",
    "Code execution possible: globals()"
  ],
  "detailed_results": {
    "JWT Authentication": {
      "category": "JWT Authentication",
      "tests_run": 10,
      "vulnerabilities": [],
      "results": [
        {
          "test": "Missing JWT",
          "endpoint": "/whoami",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Malformed JWT",
          "token": "not.a.jwt...",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Malformed JWT",
          "token": "Bearer malformed...",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Malformed JWT",
          "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Algorithm None",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Weak Secret",
          "secret": "secret",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Weak Secret",
          "secret": "password",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Weak Secret",
          "secret": "123456",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Weak Secret",
          "secret": "key",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Weak Secret",
          "secret": "jwt_secret",
          "status": 401,
          "vulnerable": false
        }
      ],
      "risk_level": "SECURE"
    },
    "Python Eval Injection": {
      "category": "Python Eval Injection",
      "tests_run": 9,
      "vulnerabilities": [
        "Code execution possible: __import__('os').system('echo ",
        "Code execution possible: open('/etc/passwd').read()",
        "Code execution possible: __import__('sys').modules",
        "Code execution possible: globals()"
      ],
      "results": [
        {
          "test": "Eval Injection",
          "payload": "__import__('os').system('echo VULNERABLE')...",
          "status": 200,
          "response": "{\"answer\":\"[MODEL RESPONSE] __import__('os').system('echo VULNERABLE')\",\"citations\":[],\"metrics\":{\"l"
        },
        {
          "test": "Eval Injection",
          "payload": "__import__('subprocess').call(['ls'])...",
          "status": 200,
          "response": "{\"answer\":\"[MODEL RESPONSE] __import__('subprocess').call(['ls'])\",\"citations\":[],\"metrics\":{\"latenc"
        },
        {
          "test": "Eval Injection",
          "payload": "open('/etc/passwd').read()...",
          "status": 200,
          "response": "{\"answer\":\"[MODEL RESPONSE] open('/etc/passwd').read()\",\"citations\":[],\"metrics\":{\"latency_ms\":0.001"
        },
        {
          "test": "Eval Injection",
          "payload": "__import__('sys').modules...",
          "status": 200,
          "response": "{\"answer\":\"[MODEL RESPONSE] __import__('sys').modules\",\"citations\":[],\"metrics\":{\"latency_ms\":0.0030"
        },
        {
          "test": "Eval Injection",
          "payload": "globals()...",
          "status": 200,
          "response": "{\"answer\":\"[MODEL RESPONSE] globals()\",\"citations\":[],\"metrics\":{\"latency_ms\":0.0019073486328125,\"gr"
        },
        {
          "test": "Eval Injection",
          "payload": "[i for i in range(10**10)]...",
          "status": 429,
          "response": null
        },
        {
          "test": "Safe Expression",
          "payload": "2 + 2",
          "status": 429,
          "allowed": false
        },
        {
          "test": "Safe Expression",
          "payload": "10 * 5",
          "status": 429,
          "allowed": false
        },
        {
          "test": "Safe Expression",
          "payload": "pow(2, 8)",
          "status": 429,
          "allowed": false
        }
      ],
      "risk_level": "CRITICAL"
    },
    "Rate Limiting": {
      "category": "Rate Limiting",
      "tests_run": 4,
      "vulnerabilities": [],
      "results": [
        {
          "test": "Rapid Requests",
          "requests": 10,
          "rate_limited": true,
          "responses": [
            429,
            429,
            429,
            429,
            429,
            429,
            429,
            429,
            429,
            429
          ]
        },
        {
          "test": "Header Bypass",
          "headers": [
            "X-Forwarded-For"
          ],
          "bypassed": false
        },
        {
          "test": "Header Bypass",
          "headers": [
            "X-Real-IP"
          ],
          "bypassed": false
        },
        {
          "test": "Header Bypass",
          "headers": [
            "CF-Connecting-IP"
          ],
          "bypassed": false
        }
      ],
      "risk_level": "SECURE"
    },
    "Input Validation": {
      "category": "Input Validation",
      "tests_run": 11,
      "vulnerabilities": [],
      "results": [
        {
          "test": "SQL Injection",
          "payload": "'; DROP TABLE users; --",
          "status": 429,
          "blocked": false
        },
        {
          "test": "SQL Injection",
          "payload": "' OR '1'='1",
          "status": 429,
          "blocked": false
        },
        {
          "test": "SQL Injection",
          "payload": "admin'--",
          "status": 429,
          "blocked": false
        },
        {
          "test": "SQL Injection",
          "payload": "1; SELECT * FROM users",
          "status": 429,
          "blocked": false
        },
        {
          "test": "XSS",
          "payload": "<script>alert('XSS')</script>",
          "status": 429,
          "sanitized": true
        },
        {
          "test": "XSS",
          "payload": "javascript:alert(1)",
          "status": 429,
          "sanitized": true
        },
        {
          "test": "XSS",
          "payload": "<img src=x onerror=alert(1)>",
          "status": 429,
          "sanitized": true
        },
        {
          "test": "XSS",
          "payload": "';alert(1);//",
          "status": 429,
          "sanitized": true
        },
        {
          "test": "Path Traversal",
          "payload": "../../../etc/passwd",
          "status": 429,
          "blocked": true
        },
        {
          "test": "Path Traversal",
          "payload": "..\\..\\..\\windows\\system32\\config\\sam",
          "status": 429,
          "blocked": true
        },
        {
          "test": "Path Traversal",
          "payload": "file:///etc/passwd",
          "status": 429,
          "blocked": true
        }
      ],
      "risk_level": "SECURE"
    },
    "Authorization": {
      "category": "Authorization",
      "tests_run": 6,
      "vulnerabilities": [],
      "results": [
        {
          "test": "Privilege Escalation",
          "attempt": {
            "sub": "admin",
            "role": "admin"
          },
          "status": 429,
          "response": null
        },
        {
          "test": "Privilege Escalation",
          "attempt": {
            "sub": "viewer",
            "role": "admin",
            "scopes": [
              "admin:*"
            ]
          },
          "status": 429,
          "response": null
        },
        {
          "test": "Privilege Escalation",
          "attempt": {
            "sub": "viewer",
            "is_admin": true
          },
          "status": 429,
          "response": null
        },
        {
          "test": "Admin Endpoint Access",
          "endpoint": "/admin",
          "status": 404,
          "blocked": true
        },
        {
          "test": "Admin Endpoint Access",
          "endpoint": "/config",
          "status": 404,
          "blocked": true
        },
        {
          "test": "Admin Endpoint Access",
          "endpoint": "/users",
          "status": 404,
          "blocked": true
        }
      ],
      "risk_level": "SECURE"
    }
  }
}
