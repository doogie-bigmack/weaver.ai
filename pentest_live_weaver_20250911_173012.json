{
  "timestamp": "2025-09-11T17:30:12.437432",
  "target": "http://localhost:8002",
  "summary": {
    "total_vulnerabilities": 4,
    "critical_categories": [],
    "high_categories": [
      "Rate Limiting"
    ]
  },
  "vulnerabilities": [
    "No rate limiting on rapid requests",
    "Rate limit bypass via ['X-Forwarded-For']",
    "Rate limit bypass via ['X-Real-IP']",
    "Rate limit bypass via ['CF-Connecting-IP']"
  ],
  "detailed_results": {
    "JWT Authentication": {
      "category": "JWT Authentication",
      "tests_run": 10,
      "vulnerabilities": [],
      "results": [
        {
          "test": "Missing JWT",
          "endpoint": "/whoami",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Malformed JWT",
          "token": "not.a.jwt...",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Malformed JWT",
          "token": "Bearer malformed...",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Malformed JWT",
          "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Algorithm None",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Weak Secret",
          "secret": "secret",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Weak Secret",
          "secret": "password",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Weak Secret",
          "secret": "123456",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Weak Secret",
          "secret": "key",
          "status": 401,
          "vulnerable": false
        },
        {
          "test": "Weak Secret",
          "secret": "jwt_secret",
          "status": 401,
          "vulnerable": false
        }
      ],
      "risk_level": "SECURE"
    },
    "Python Eval Injection": {
      "category": "Python Eval Injection",
      "tests_run": 9,
      "vulnerabilities": [],
      "results": [
        {
          "test": "Eval Injection",
          "payload": "__import__('os').system('echo VULNERABLE')...",
          "status": 401,
          "response": null
        },
        {
          "test": "Eval Injection",
          "payload": "__import__('subprocess').call(['ls'])...",
          "status": 401,
          "response": null
        },
        {
          "test": "Eval Injection",
          "payload": "open('/etc/passwd').read()...",
          "status": 401,
          "response": null
        },
        {
          "test": "Eval Injection",
          "payload": "__import__('sys').modules...",
          "status": 401,
          "response": null
        },
        {
          "test": "Eval Injection",
          "payload": "globals()...",
          "status": 401,
          "response": null
        },
        {
          "test": "Eval Injection",
          "payload": "[i for i in range(10**10)]...",
          "status": 401,
          "response": null
        },
        {
          "test": "Safe Expression",
          "payload": "2 + 2",
          "status": 401,
          "allowed": false
        },
        {
          "test": "Safe Expression",
          "payload": "10 * 5",
          "status": 401,
          "allowed": false
        },
        {
          "test": "Safe Expression",
          "payload": "pow(2, 8)",
          "status": 401,
          "allowed": false
        }
      ],
      "risk_level": "SECURE"
    },
    "Rate Limiting": {
      "category": "Rate Limiting",
      "tests_run": 4,
      "vulnerabilities": [
        "No rate limiting on rapid requests",
        "Rate limit bypass via ['X-Forwarded-For']",
        "Rate limit bypass via ['X-Real-IP']",
        "Rate limit bypass via ['CF-Connecting-IP']"
      ],
      "results": [
        {
          "test": "Rapid Requests",
          "requests": 10,
          "rate_limited": false,
          "responses": [
            401,
            401,
            401,
            401,
            401,
            401,
            401,
            401,
            401,
            401
          ]
        },
        {
          "test": "Header Bypass",
          "headers": [
            "X-Forwarded-For"
          ],
          "bypassed": true
        },
        {
          "test": "Header Bypass",
          "headers": [
            "X-Real-IP"
          ],
          "bypassed": true
        },
        {
          "test": "Header Bypass",
          "headers": [
            "CF-Connecting-IP"
          ],
          "bypassed": true
        }
      ],
      "risk_level": "HIGH"
    },
    "Input Validation": {
      "category": "Input Validation",
      "tests_run": 11,
      "vulnerabilities": [],
      "results": [
        {
          "test": "SQL Injection",
          "payload": "'; DROP TABLE users; --",
          "status": 401,
          "blocked": false
        },
        {
          "test": "SQL Injection",
          "payload": "' OR '1'='1",
          "status": 401,
          "blocked": false
        },
        {
          "test": "SQL Injection",
          "payload": "admin'--",
          "status": 401,
          "blocked": false
        },
        {
          "test": "SQL Injection",
          "payload": "1; SELECT * FROM users",
          "status": 401,
          "blocked": false
        },
        {
          "test": "XSS",
          "payload": "<script>alert('XSS')</script>",
          "status": 401,
          "sanitized": true
        },
        {
          "test": "XSS",
          "payload": "javascript:alert(1)",
          "status": 401,
          "sanitized": true
        },
        {
          "test": "XSS",
          "payload": "<img src=x onerror=alert(1)>",
          "status": 401,
          "sanitized": true
        },
        {
          "test": "XSS",
          "payload": "';alert(1);//",
          "status": 401,
          "sanitized": true
        },
        {
          "test": "Path Traversal",
          "payload": "../../../etc/passwd",
          "status": 401,
          "blocked": true
        },
        {
          "test": "Path Traversal",
          "payload": "..\\..\\..\\windows\\system32\\config\\sam",
          "status": 401,
          "blocked": true
        },
        {
          "test": "Path Traversal",
          "payload": "file:///etc/passwd",
          "status": 401,
          "blocked": true
        }
      ],
      "risk_level": "SECURE"
    },
    "Authorization": {
      "category": "Authorization",
      "tests_run": 6,
      "vulnerabilities": [],
      "results": [
        {
          "test": "Privilege Escalation",
          "attempt": {
            "user_id": "admin",
            "role": "admin"
          },
          "status": 401,
          "response": null
        },
        {
          "test": "Privilege Escalation",
          "attempt": {
            "user_id": "viewer",
            "role": "admin",
            "scopes": [
              "admin:*"
            ]
          },
          "status": 401,
          "response": null
        },
        {
          "test": "Privilege Escalation",
          "attempt": {
            "user_id": "viewer",
            "is_admin": true
          },
          "status": 401,
          "response": null
        },
        {
          "test": "Admin Endpoint Access",
          "endpoint": "/admin",
          "status": 404,
          "blocked": true
        },
        {
          "test": "Admin Endpoint Access",
          "endpoint": "/config",
          "status": 404,
          "blocked": true
        },
        {
          "test": "Admin Endpoint Access",
          "endpoint": "/users",
          "status": 404,
          "blocked": true
        }
      ],
      "risk_level": "SECURE"
    }
  }
}
