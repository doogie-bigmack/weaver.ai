# Security Configuration Example for Weaver AI
# Copy this file to .env and adjust values for your environment
# CRITICAL: Never commit .env files with real secrets to version control

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
# Enable CORS middleware
WEAVER_CORS_ENABLED=true

# Allowed origins (comma-separated or JSON array)
# Production: Use specific origins only, never use "*"
# Example: WEAVER_CORS_ORIGINS=https://app.example.com,https://admin.example.com
# Or: WEAVER_CORS_ORIGINS=["https://app.example.com","https://admin.example.com"]
WEAVER_CORS_ORIGINS=

# Allow credentials (cookies, authorization headers)
# Only enable if your frontend needs to send credentials
WEAVER_CORS_ALLOW_CREDENTIALS=false

# Allowed HTTP methods
WEAVER_CORS_ALLOW_METHODS=["GET","POST","PUT","DELETE","OPTIONS"]

# Allowed headers (* allows all, but be specific in production)
WEAVER_CORS_ALLOW_HEADERS=["*"]

# Preflight request cache duration (seconds)
WEAVER_CORS_MAX_AGE=600

# ============================================================================
# SECURITY HEADERS CONFIGURATION
# ============================================================================
# Enable security headers middleware
WEAVER_SECURITY_HEADERS_ENABLED=true

# HSTS (HTTP Strict Transport Security) max age in seconds
# 31536000 = 1 year (recommended minimum)
# 63072000 = 2 years (recommended for production)
WEAVER_HSTS_MAX_AGE=31536000

# CSP (Content Security Policy) violation report endpoint
# Set up an endpoint to collect CSP violations for monitoring
WEAVER_CSP_REPORT_URI=

# ============================================================================
# CSRF PROTECTION CONFIGURATION
# ============================================================================
# Enable CSRF protection middleware
WEAVER_CSRF_ENABLED=true

# Secret key for signing CSRF tokens (generate a strong random key)
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
WEAVER_CSRF_SECRET_KEY=

# Require secure (HTTPS) cookies
# Set to true in production, false for local development
WEAVER_CSRF_COOKIE_SECURE=true

# Additional paths to exclude from CSRF protection (comma-separated)
# Default excludes: /health, /metrics, /docs, /redoc, /openapi.json
WEAVER_CSRF_EXCLUDE_PATHS=

# ============================================================================
# HOST HEADER VALIDATION
# ============================================================================
# Allowed Host headers (comma-separated)
# Protects against Host header injection attacks
# Example: ALLOWED_HOSTS=api.example.com,app.example.com,localhost
ALLOWED_HOSTS=

# ============================================================================
# PYTHON EVAL SECURITY (CRITICAL)
# ============================================================================
# WARNING: Enabling Python eval is a CRITICAL security risk!
# This allows arbitrary code execution and should NEVER be enabled in production
# Only use in isolated development environments
WEAVER_ENABLE_PYTHON_EVAL=false

# ============================================================================
# AUTHENTICATION & AUTHORIZATION
# ============================================================================
# Authentication mode (api_key or jwt)
WEAVER_AUTH_MODE=api_key

# API Keys (comma-separated) - use strong, random keys
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
WEAVER_ALLOWED_API_KEYS=

# JWT public key (for jwt auth mode)
WEAVER_JWT_PUBLIC_KEY=

# ============================================================================
# RATE LIMITING
# ============================================================================
# Requests per second per user
WEAVER_RATELIMIT_RPS=5

# Burst capacity (maximum requests in a burst)
WEAVER_RATELIMIT_BURST=10

# ============================================================================
# REDIS CONFIGURATION (for distributed systems)
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379

# ============================================================================
# MONITORING & LOGGING
# ============================================================================
# Audit log path
WEAVER_AUDIT_PATH=./audit.log

# PII redaction in responses
WEAVER_PII_REDACT=true

# ============================================================================
# DEPLOYMENT CHECKLIST
# ============================================================================
# Before deploying to production, ensure:
# 1. [ ] Generate strong CSRF_SECRET_KEY
# 2. [ ] Set specific CORS_ORIGINS (no wildcards)
# 3. [ ] Configure ALLOWED_HOSTS
# 4. [ ] Set CSRF_COOKIE_SECURE=true
# 5. [ ] Ensure ENABLE_PYTHON_EVAL=false
# 6. [ ] Generate strong API keys
# 7. [ ] Configure proper rate limits
# 8. [ ] Set up CSP report collection
# 9. [ ] Enable HTTPS/TLS
# 10. [ ] Review all security settings

# ============================================================================
# SECURITY NOTES
# ============================================================================
# - Never use wildcard (*) for CORS origins in production
# - Always use HTTPS in production (required for secure cookies)
# - Regularly rotate API keys and secrets
# - Monitor security headers with tools like securityheaders.com
# - Set up alerting for security events (failed auth, CSRF violations)
# - Keep dependencies updated with pip-audit
# - Perform regular security scans with OWASP ZAP or similar
